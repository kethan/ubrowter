var ubrow=function(t){"use strict";function e(t,e){var r,o,n,s="";for(r in t)if(void 0!==(n=t[r]))if(Array.isArray(n))for(o=0;o<n.length;o++)s&&(s+="&"),s+=encodeURIComponent(r)+"="+encodeURIComponent(n[o]);else s&&(s+="&"),s+=encodeURIComponent(r)+"="+encodeURIComponent(n);return(e||"")+s}function r(t){if(!t)return"";var e=decodeURIComponent(t);return"false"!==e&&("true"===e||(0*+e==0?+e:e))}function o(t){for(var e,o,n={},s=t.split("&");e=s.shift();)void 0!==n[o=(e=e.split("=")).shift()]?n[o]=[].concat(n[o],r(e.shift())):n[o]=r(e.shift());return n}function n(t,e){const r=[],o=new RegExp("^"+t.replace(/\((.*?)\)/g,"(?:$1)?").replace(/(\(\?)?:\w+/g,((t,e)=>(r.push(t.slice(1)),e?t:"([^/?]+)"))).replace(/\*/g,(()=>(r.push("path"),"([^?]*?)")))+"(?:\\?([\\s\\S]*))?$").exec(e),n={};if(o)for(let s=0;s<r.length;s++)n[r[s]]=o[s+1];return{match:!!o,params:n,pattern:t,url:e}}return t.Browter=class extends class{constructor(){this.routes=[],this.handlers=[]}use(...t){return this.handlers=[...this.handlers,...t],this}get(t,...e){return this.routes.push({path:t,method:"GET",handlers:e}),this}handler({req:t,res:e,onError:r,onMatch:s,onNoMatch:i}){let h=!1;for(const{path:a,handlers:c}of this.routes.filter((e=>e.method.toLowerCase()==t.method.toLowerCase()))){let s=n(a,t.url);if(s.match){h=!0;let n=[...this.handlers,...c];t.params=s.params,t.path=s.url,t.routePath=a,t.query=o(s.url.split("?")[1]||"");let i=(t,e)=>{try{let o=n.shift();o?o(t,e,(o=>o?r(o,t,e):i(t,e))):r(null,t,e)}catch(o){r(o,t,e)}};i(t,e)}}h||i(t,e)}}{constructor(){super(),this.listener={onError:()=>{},onMatch:()=>{},onNoMatch:()=>{}},this.click=t=>{var e=t.target.closest("a"),r=e&&e.getAttribute("href");t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||t.button||t.defaultPrevented||r&&!e.target&&e.host===location.host&&"#"!=r[0]&&(t.preventDefault(),r!=location.pathname+location.search&&this.redirect(r))}}redirect(t,r={},o=!1){let n={url:t,method:"GET"};t+=0!==Object.keys(r).length?e(r,"?"):"";let s={onMatch:(e,r)=>{t==location.pathname+location.search||o?history.replaceState(t,"",t):history.pushState(t,"",t),this.listener.onMatch(e,r)}};this.handler({req:n,res:{redirect:this.redirect.bind(this),send:(t=>s.onMatch(n,t)).bind(this)},onError:(t,e,r)=>{this.listener.onError(t,e,r)},onMatch:s.onMatch,onNoMatch:(t,e)=>{this.listener.onNoMatch(t,e)}})}route(){this.redirect(location.pathname+location.search)}unlisten(){removeEventListener("popstate",this.route.bind(this)),removeEventListener("click",this.click)}listen(t=this.listener){this.listener=t,addEventListener("popstate",this.route.bind(this)),addEventListener("click",this.click),this.route()}},t.decode=o,t.encode=e,t.pathToRegex=n,Object.defineProperty(t,"__esModule",{value:!0}),t[Symbol.toStringTag]="Module",t}({});
